[comment]: <> (This README.md was generated by tools/collect_metrics.py.)
[comment]: <> (Please modify docs/README.md.in and/or collect_metrics.py to make permanent changes.)
[![Ask DeepWiki](https://deepwiki.com/badge.svg)](https://deepwiki.com/tenstorrent/pytorch2.0_ttnn)

# PyTorch 2.0 TTNN Compiler
This project allows to run PyTorch code on [Tenstorrent](https://tenstorrent.com/) hardware.

## Supported Models

The table below summarizes the results of running various ML models through our TTNN compiler. For each model, we track whether the run was successful, the number of operations before and after conversion, the number of `to_device` and `from_device` operations, performance metrics, and accuracy.

| Model                                                                                                | Status   | Batch   | Compiled First Run (ms)   |   Original Throughput (Inferences Per Second) | Compiled Throughput (Inferences Per Second)   | Accuracy (%)   | Torch Ops Before (Unique Ops)   | Torch Ops Remain (Unique Ops)   | To/From Device Ops   |
|:-----------------------------------------------------------------------------------------------------|:---------|:--------|:--------------------------|----------------------------------------------:|:----------------------------------------------|:---------------|:--------------------------------|:--------------------------------|:---------------------|
| [Autoencoder (linear)](<docs/models/Autoencoder (linear)>)                                           | ✅       | 1       | 394.53                    |                                   0.309325    | 564.9717514124294                             | 100.0          | 22 (3)                          | 0 (0)                           | 0                    |
| [BERT](<docs/models/BERT>)                                                                           | ✅       | 8       | 42004.35                  |                                   0.010773    | 41.00461301896464                             | 99.69          | 1465 (22)                       | 0 (0)                           | 0                    |
| [DPR](<docs/models/DPR>)                                                                             | ✅       | 1       | 19194.97                  |                                   0.267544    | 80.77544426494346                             | 99.38          | 720 (22)                        | 0 (0)                           | 1                    |
| [HardNet](<docs/models/HardNet>)                                                                     | ✅       | 1       | 132306.68                 |                                   0.196947    | 25.614754098360656                            | 98.41          | 245 (10)                        | 0 (0)                           | 124                  |
| [Llama](<docs/models/Llama>)                                                                         | ✅       | 1       | 172718.3                  |                                   0.00528175  | 0.006501372309667125                          | 100.0          | 40 (11)                         | 0 (0)                           | 2                    |
| [MLPMixer](<docs/models/MLPMixer>)                                                                   | ✅       | 1       | 14471.44                  |                                   0.185228    | 94.2507068803016                              | 99.99          | 253 (11)                        | 0 (0)                           | 0                    |
| [Mnist](<docs/models/Mnist>)                                                                         | ✅       | 1       | 4277.75                   |                                  30.4785      | 442.4778761061947                             | 99.42          | 14 (8)                          | 0 (0)                           | 1                    |
| [MobileNetV2](<docs/models/MobileNetV2>)                                                             | ✅       | 1       | 72809.4                   |                                   0.950923    | 47.641734159123395                            | 99.09          | 154 (9)                         | 0 (0)                           | 0                    |
| [OpenPose V2](<docs/models/OpenPose V2>)                                                             | ✅       | 1       | 17232.9                   |                                   0.327679    | 34.036759700476516                            | 91.49          | 155 (7)                         | 0 (0)                           | 6                    |
| [Perceiver IO](<docs/models/Perceiver IO>)                                                           | ✅       | 1       | 37220.58                  |                                   0.0235186   | 19.646365422396855                            | 99.95          | 1531 (20)                       | 0 (0)                           | 1                    |
| [ResNet18](<docs/models/ResNet18>)                                                                   | ✅       | 1       | 33189.6                   |                                   0.451451    | 113.63636363636363                            | 98.99          | 70 (9)                          | 0 (0)                           | 1                    |
| [ResNet50](<docs/models/ResNet50>)                                                                   | ✅       | 4       | 51547.08                  |                                   0.940464    | 46.56577415599534                             | 98.61          | 176 (9)                         | 0 (0)                           | 1                    |
| [RoBERTa](<docs/models/RoBERTa>)                                                                     | ✅       | 1       | 29854.88                  |                                   0.0795395   | 20.383204239706483                            | 7.19           | 719 (21)                        | 0 (0)                           | 3                    |
| [SqueezeBERT](<docs/models/SqueezeBERT>)                                                             | ✅       | 1       | 7460.18                   |                                   0.984552    | 3.794922393837046                             | 100.0          | 16 (9)                          | 0 (0)                           | 3                    |
| [U-Net](<docs/models/U-Net>)                                                                         | ✅       | 1       | 48774.89                  |                                   0.024158    | 82.10180623973727                             | 100.0          | 68 (6)                          | 0 (0)                           | 12                   |
| [Unet-brain](<docs/models/Unet-brain>)                                                               | ✅       | 1       | 2608.78                   |                                   0.0241303   | 80.45052292839904                             | N/A            | 68 (6)                          | 0 (0)                           | 12                   |
| [Unet-carvana](<docs/models/Unet-carvana>)                                                           | ✅       | 1       | 27269.49                  |                                   0.0115201   | 24.551927326295118                            | 99.69          | 67 (5)                          | 0 (0)                           | 12                   |
| [YOLOv5](<docs/models/YOLOv5>)                                                                       | ✅       | 1       | 19656.49                  |                                   0.0734342   | 0.09374399452535072                           | 99.98          | 3 (3)                           | 0 (0)                           | 0                    |
| [albert/albert-base-v2](<docs/models/albert/albert-base-v2>)                                         | ✅       | 1       | 22213.33                  |                                   0.949397    | 58.41121495327103                             | 98.82          | 791 (21)                        | 0 (0)                           | 3                    |
| [albert/albert-base-v2-classification](<docs/models/albert/albert-base-v2-classification>)           | ✅       | 1       | 7648.32                   |                                   0.658996    | 72.56894049346879                             | 99.97          | 779 (21)                        | 0 (0)                           | 2                    |
| [albert/albert-large-v2](<docs/models/albert/albert-large-v2>)                                       | ✅       | 1       | 19314.14                  |                                   0.34832     | 29.612081729345572                            | 98.95          | 1547 (21)                       | 0 (0)                           | 3                    |
| [albert/albert-xlarge-v2](<docs/models/albert/albert-xlarge-v2>)                                     | ✅       | 1       | 31789.88                  |                                   0.118792    | 12.815583749839805                            | 97.36          | 1547 (21)                       | 0 (0)                           | 3                    |
| [densenet121](<docs/models/densenet121>)                                                             | ✅       | 1       | 100314.9                  |                                   0.296854    | 15.90836780146357                             | 99.74          | 432 (10)                        | 0 (0)                           | 597                  |
| [densenet161](<docs/models/densenet161>)                                                             | ✅       | 1       | 131893.26                 |                                   0.124352    | 13.333333333333334                            | 99.49          | 572 (10)                        | 0 (0)                           | 1147                 |
| [densenet169](<docs/models/densenet169>)                                                             | ✅       | 1       | 173017.9                  |                                   0.248791    | 13.299640909695439                            | 99.59          | 600 (10)                        | 0 (0)                           | 1241                 |
| [distilbert-base-uncased](<docs/models/distilbert-base-uncased>)                                     | ✅       | 1       | 21782.75                  |                                   0.544665    | 94.6073793755913                              | 99.9           | 361 (16)                        | 0 (0)                           | 1                    |
| [dla34.in1k](<docs/models/dla34.in1k>)                                                               | ✅       | 1       | 67142.24                  |                                   0.294632    | 53.333333333333336                            | 99.5           | 135 (9)                         | 0 (0)                           | 23                   |
| [ese_vovnet19b_dw.ra_in1k](<docs/models/ese_vovnet19b_dw.ra_in1k>)                                   | ✅       | 1       | 59779.27                  |                                   0.412431    | 52.99417064122946                             | 99.44          | 111 (12)                        | 0 (0)                           | 19                   |
| [ghostnet_100.in1k](<docs/models/ghostnet_100.in1k>)                                                 | ✅       | 1       | 146927.37                 |                                   0.547735    | 23.623907394283016                            | 99.6           | 515 (14)                        | 0 (0)                           | 64                   |
| [mobilenet_v2](<docs/models/mobilenet_v2>)                                                           | ✅       | 1       | 55136.61                  |                                   1.28563     | 49.77600796416127                             | 99.09          | 154 (9)                         | 0 (0)                           | 0                    |
| [mobilenet_v3_large](<docs/models/mobilenet_v3_large>)                                               | ✅       | 1       | 68860.31                  |                                   0.845766    | 40.25764895330113                             | 99.15          | 188 (11)                        | 0 (0)                           | 0                    |
| [mobilenet_v3_small](<docs/models/mobilenet_v3_small>)                                               | ✅       | 1       | 90935.55                  |                                   0.964813    | 49.48045522018803                             | 99.09          | 158 (11)                        | 0 (0)                           | 0                    |
| [mobilenetv1_100.ra4_e3600_r224_in1k](<docs/models/mobilenetv1_100.ra4_e3600_r224_in1k>)             | ✅       | 1       | 61369.91                  |                                   0.628539    | 54.34782608695653                             | 96.04          | 85 (7)                          | 0 (0)                           | 0                    |
| [regnet_x_16gf](<docs/models/regnet_x_16gf>)                                                         | ✅       | 1       | 45309.46                  |                                   0.0702496   | 13.915947676036739                            | 99.59          | 235 (8)                         | 0 (0)                           | 0                    |
| [regnet_x_1_6gf](<docs/models/regnet_x_1_6gf>)                                                       | ✅       | 1       | 44941.86                  |                                   0.50917     | 38.78975950349108                             | 99.47          | 195 (8)                         | 0 (0)                           | 0                    |
| [regnet_x_32gf](<docs/models/regnet_x_32gf>)                                                         | ✅       | 1       | 88145.51                  |                                   0.0327645   | 8.443806467955755                             | 99.27          | 245 (8)                         | 0 (0)                           | 0                    |
| [regnet_x_3_2gf](<docs/models/regnet_x_3_2gf>)                                                       | ✅       | 1       | 60552.11                  |                                   0.303998    | 32.25806451612903                             | 99.5           | 265 (8)                         | 0 (0)                           | 0                    |
| [regnet_x_400mf](<docs/models/regnet_x_400mf>)                                                       | ✅       | 1       | 65564.11                  |                                   1.12925     | 33.863867253640365                            | 99.66          | 235 (8)                         | 0 (0)                           | 0                    |
| [regnet_x_800mf](<docs/models/regnet_x_800mf>)                                                       | ✅       | 1       | 41891.0                   |                                   0.842169    | 43.17789291882556                             | 99.44          | 175 (8)                         | 0 (0)                           | 0                    |
| [regnet_x_8gf](<docs/models/regnet_x_8gf>)                                                           | ✅       | 1       | 41061.58                  |                                   0.134302    | 20.75980900975711                             | 98.99          | 245 (8)                         | 0 (0)                           | 0                    |
| [regnet_y_16gf](<docs/models/regnet_y_16gf>)                                                         | ✅       | 1       | 107515.1                  |                                   0.0658522   | 11.649580615097856                            | 99.66          | 303 (10)                        | 0 (0)                           | 0                    |
| [regnet_y_1_6gf](<docs/models/regnet_y_1_6gf>)                                                       | ✅       | 1       | 103773.91                 |                                   0.430291    | 19.880715705765407                            | 99.69          | 447 (10)                        | 0 (0)                           | 0                    |
| [regnet_y_32gf](<docs/models/regnet_y_32gf>)                                                         | ✅       | 1       | 88462.83                  |                                   0.032467    | 7.905138339920948                             | 99.72          | 335 (10)                        | 0 (0)                           | 0                    |
| [regnet_y_3_2gf](<docs/models/regnet_y_3_2gf>)                                                       | ✅       | 1       | 73262.85                  |                                   0.285136    | 23.078698361412414                            | 99.82          | 351 (10)                        | 0 (0)                           | 0                    |
| [regnet_y_400mf](<docs/models/regnet_y_400mf>)                                                       | ✅       | 1       | 65258.07                  |                                   1.33253     | 39.635354736424894                            | 99.64          | 271 (10)                        | 0 (0)                           | 0                    |
| [regnet_y_800mf](<docs/models/regnet_y_800mf>)                                                       | ✅       | 1       | 50783.64                  |                                   0.911062    | 42.643923240938165                            | 99.59          | 239 (10)                        | 0 (0)                           | 0                    |
| [regnet_y_8gf](<docs/models/regnet_y_8gf>)                                                           | ✅       | 1       | 67967.46                  |                                   0.122728    | 17.85395465095519                             | 99.83          | 287 (10)                        | 0 (0)                           | 0                    |
| [resnet101](<docs/models/resnet101>)                                                                 | ✅       | 1       | 13813.88                  |                                   0.135669    | 27.3000273000273                              | 99.25          | 346 (9)                         | 0 (0)                           | 1                    |
| [resnet152](<docs/models/resnet152>)                                                                 | ✅       | 1       | 82399.82                  |                                   0.0890224   | 16.110842597067826                            | 99.09          | 516 (9)                         | 0 (0)                           | 1                    |
| [resnet18](<docs/models/resnet18>)                                                                   | ✅       | 1       | 19427.13                  |                                   0.467312    | 112.73957158962797                            | 99.61          | 70 (9)                          | 0 (0)                           | 1                    |
| [resnet34](<docs/models/resnet34>)                                                                   | ✅       | 1       | 34805.76                  |                                   0.232595    | 71.99424046076314                             | 99.07          | 126 (9)                         | 0 (0)                           | 1                    |
| [resnet50](<docs/models/resnet50>)                                                                   | ✅       | 1       | 34446.85                  |                                   0.24238     | 50.658561296859176                            | 98.61          | 176 (9)                         | 0 (0)                           | 1                    |
| [resnext101_32x8d](<docs/models/resnext101_32x8d>)                                                   | ✅       | 1       | 49754.6                   |                                   0.0628786   | 8.149959250203748                             | 99.57          | 346 (9)                         | 0 (0)                           | 1                    |
| [resnext101_64x4d](<docs/models/resnext101_64x4d>)                                                   | ✅       | 1       | 83962.53                  |                                   0.0663809   | 8.540438978563499                             | 99.65          | 346 (9)                         | 0 (0)                           | 1                    |
| [resnext50_32x4d](<docs/models/resnext50_32x4d>)                                                     | ✅       | 1       | 28843.27                  |                                   0.220408    | 34.698126301179734                            | 99.44          | 176 (9)                         | 0 (0)                           | 1                    |
| [textattack/albert-base-v2-imdb](<docs/models/textattack/albert-base-v2-imdb>)                       | ✅       | 1       | 23967.04                  |                                   0.843483    | 72.62164124909224                             | 100.0          | 782 (22)                        | 0 (0)                           | 2                    |
| [tf_efficientnet_lite0.in1k](<docs/models/tf_efficientnet_lite0.in1k>)                               | ✅       | 1       | 79594.04                  |                                   1.19066     | 28.935185185185183                            | 99.3           | 149 (9)                         | 0 (0)                           | 5                    |
| [tf_efficientnet_lite1.in1k](<docs/models/tf_efficientnet_lite1.in1k>)                               | ✅       | 1       | 54120.79                  |                                   0.739563    | 21.114864864864863                            | 99.56          | 194 (9)                         | 0 (0)                           | 5                    |
| [tf_efficientnet_lite2.in1k](<docs/models/tf_efficientnet_lite2.in1k>)                               | ✅       | 1       | 100536.75                 |                                   0.44177     | 13.440860215053762                            | 99.21          | 194 (9)                         | 0 (0)                           | 5                    |
| [twmkn9/albert-base-v2-squad2](<docs/models/twmkn9/albert-base-v2-squad2>)                           | ✅       | 1       | 16097.18                  |                                   0.650009    | 70.72135785007072                             | 99.86          | 783 (23)                        | 0 (0)                           | 2                    |
| [vgg11](<docs/models/vgg11>)                                                                         | ✅       | 1       | 29930.33                  |                                   0.0899964   | 78.43137254901961                             | 99.65          | 33 (8)                          | 0 (0)                           | 5                    |
| [vgg11_bn](<docs/models/vgg11_bn>)                                                                   | ✅       | 1       | 2833.96                   |                                   0.10405     | 72.99270072992701                             | 98.99          | 41 (9)                          | 0 (0)                           | 5                    |
| [vgg13](<docs/models/vgg13>)                                                                         | ✅       | 1       | 47280.48                  |                                   0.048781    | 67.34006734006734                             | 99.38          | 37 (8)                          | 0 (0)                           | 5                    |
| [vgg13_bn](<docs/models/vgg13_bn>)                                                                   | ✅       | 1       | 6242.29                   |                                   0.0498829   | 59.808612440191396                            | 97.35          | 47 (9)                          | 0 (0)                           | 5                    |
| [vgg16](<docs/models/vgg16>)                                                                         | ✅       | 1       | 2545.01                   |                                   0.0371729   | 51.65289256198347                             | 99.44          | 43 (8)                          | 0 (0)                           | 5                    |
| [vgg16_bn](<docs/models/vgg16_bn>)                                                                   | ✅       | 1       | 43176.29                  |                                   0.0456384   | 48.63813229571984                             | 98.38          | 56 (9)                          | 0 (0)                           | 5                    |
| [vgg19](<docs/models/vgg19>)                                                                         | ✅       | 1       | 2111.83                   |                                   0.0408021   | 43.365134431916736                            | 99.27          | 49 (8)                          | 0 (0)                           | 5                    |
| [vgg19_bn](<docs/models/vgg19_bn>)                                                                   | ✅       | 1       | 3647.74                   |                                   0.0353174   | 39.69829297340214                             | 96.97          | 65 (9)                          | 0 (0)                           | 5                    |
| [wide_resnet101_2](<docs/models/wide_resnet101_2>)                                                   | ✅       | 1       | 62350.33                  |                                   0.0442556   | 18.684603886397607                            | 99.2           | 346 (9)                         | 0 (0)                           | 1                    |
| [wide_resnet50_2](<docs/models/wide_resnet50_2>)                                                     | ✅       | 1       | 53390.28                  |                                   0.0856194   | 35.38570417551309                             | 98.8           | 176 (9)                         | 0 (0)                           | 1                    |
| [xception71.tf_in1k](<docs/models/xception71.tf_in1k>)                                               | ✅       | 1       | 114120.24                 |                                   0.0557522   | 4.280089025851738                             | 99.21          | 393 (9)                         | 0 (0)                           | 0                    |
| [Autoencoder (conv)](<docs/models/Autoencoder (conv)>)                                               | 🚧       | 1       | 2997.65                   |                                   0.673265    | 361.01083032490976                            | 100.0          | 9 (3)                           | 1 (1)                           | 1                    |
| [Autoencoder (conv)-train](<docs/models/Autoencoder (conv)-train>)                                   | 🚧       | 1       | 10917.99                  |                                   0.43861     | 153.84615384615387                            | 100.0          | 24 (7)                          | 11 (4)                          | 0                    |
| [Autoencoder (linear)-train](<docs/models/Autoencoder (linear)-train>)                               | 🚧       | 1       | 12114.58                  |                                   0.20744     | 51.70630816959669                             | 100.0          | 104 (8)                         | 14 (2)                          | 0                    |
| [Bloom](<docs/models/Bloom>)                                                                         | 🚧       | 1       | 42841.38                  |                                   0.0315441   | 0.9194303209731249                            | 98.86          | 1405 (27)                       | 2 (2)                           | 0                    |
| [CLIP](<docs/models/CLIP>)                                                                           | 🚧       | 1       | 49520.75                  |                                   0.16814     | 6.358087487283825                             | 99.56          | 1397 (30)                       | 7 (6)                           | 2                    |
| [CLIP-train](<docs/models/CLIP-train>)                                                               | 🚧       | 1       | 73432.31                  |                                   0.0431682   | 0.5099491070791135                            | 100.0          | 3944 (44)                       | 265 (16)                        | 5                    |
| [DETR](<docs/models/DETR>)                                                                           | 🚧       | 1       | 114350.13                 |                                   0.0111944   | 0.2074181009628348                            | 41.98          | 1663 (42)                       | 9 (6)                           | 3                    |
| [DINOv2](<docs/models/DINOv2>)                                                                       | 🚧       | 1       | 23744.41                  |                                   0.0616348   | 12.825445684237527                            | 98.99          | 928 (25)                        | 16 (1)                          | 2                    |
| [Falcon-7B](<docs/models/Falcon-7B>)                                                                 | 🚧       | 1       | 70133.76                  |                                   0.0127877   | 0.02024584529947148                           | 100.0          | 94 (15)                         | 5 (5)                           | 3                    |
| [GLPN-KITTI](<docs/models/GLPN-KITTI>)                                                               | 🚧       | 1       | 241928.43                 |                                   0.00817136  | 0.01680929917325143                           | 99.75          | 2959 (26)                       | 22 (2)                          | 6                    |
| [GPT-2](<docs/models/GPT-2>)                                                                         | 🚧       | 1       | 24988.73                  |                                   0.361184    | 35.523978685612796                            | 99.98          | 745 (29)                        | 2 (2)                           | 2                    |
| [HardNet-train](<docs/models/HardNet-train>)                                                         | 🚧       | 1       | 136172.56                 |                                   0.0750814   | 0.10900382494421729                           | 100.0          | 867 (21)                        | 412 (9)                         | 120                  |
| [MLPMixer-train](<docs/models/MLPMixer-train>)                                                       | 🚧       | 1       | 34968.83                  |                                   0.0577061   | 0.10152232729783098                           | 100.0          | 616 (19)                        | 100 (5)                         | 0                    |
| [Mnist-train](<docs/models/Mnist-train>)                                                             | 🚧       | 1       | 13558.46                  |                                   0.306861    | 30.41362530413625                             | 100.0          | 46 (15)                         | 10 (6)                          | 0                    |
| [MobileNetSSD](<docs/models/MobileNetSSD>)                                                           | 🚧       | 1       | 177594.3                  |                                   1.24713     | 0.4535579352228557                            | 38.39          | 447 (28)                        | 5 (2)                           | 32                   |
| [OpenPose V2-train](<docs/models/OpenPose V2-train>)                                                 | 🚧       | 1       | 64659.67                  |                                   0.0937686   | 0.12316909145551377                           | 100.0          | 523 (14)                        | 246 (7)                         | 6                    |
| [ResNet18-train](<docs/models/ResNet18-train>)                                                       | 🚧       | 1       | 33843.32                  |                                   0.192351    | 0.2737850787132101                            | 100.0          | 241 (19)                        | 121 (9)                         | 0                    |
| [ResNet50-train](<docs/models/ResNet50-train>)                                                       | 🚧       | 1       | 49110.07                  |                                   0.0785246   | 0.1031922523256954                            | 100.0          | 616 (19)                        | 318 (9)                         | 0                    |
| [SegFormer](<docs/models/SegFormer>)                                                                 | 🚧       | 1       | 24520.16                  |                                   0.0266442   | 3.2967395246101607                            | 99.85          | 676 (22)                        | 16 (1)                          | 4                    |
| [SegFormer-train](<docs/models/SegFormer-train>)                                                     | 🚧       | 1       | 147785.81                 |                                   0.012787    | 0.029537507613292584                          | 100.0          | 1794 (36)                       | 156 (12)                        | 4                    |
| [Stable Diffusion V2](<docs/models/Stable Diffusion V2>)                                             | 🚧       | 1       | 1839128.59                |                                   0.000556509 | 0.0005507019924959805                         | 99.97          | 29 (14)                         | 11 (5)                          | 4                    |
| [U-Net-train](<docs/models/U-Net-train>)                                                             | 🚧       | 1       | 80278.35                  |                                   0.0127622   | 0.025004819678993127                          | 100.0          | 236 (15)                        | 122 (8)                         | 8                    |
| [Unet-brain-train](<docs/models/Unet-brain-train>)                                                   | 🚧       | 1       | 49603.46                  |                                   0.0125559   | 0.025115266515673685                          | 100.0          | 236 (15)                        | 122 (8)                         | 8                    |
| [Unet-carvana-train](<docs/models/Unet-carvana-train>)                                               | 🚧       | 1       | 149397.55                 |                                   0.00532762  | 0.00998930744531054                           | 100.0          | 232 (13)                        | 121 (7)                         | 8                    |
| [ViLT](<docs/models/ViLT>)                                                                           | 🚧       | 1       | 33450.35                  |                                   0.0465907   | 0.054204802003409484                          | 87.94          | 42 (16)                         | 5 (4)                           | 3                    |
| [YOLOS](<docs/models/YOLOS>)                                                                         | 🚧       | 1       | 33791.27                  |                                   0.0679289   | 3.6789051578250316                            | 98.6           | 952 (27)                        | 17 (2)                          | 2                    |
| [YOLOv3](<docs/models/YOLOv3>)                                                                       | 🚧       | 1       | 57754.95                  |                                   0.00538088  | 16.789791806581597                            | 98.63          | 250 (7)                         | 2 (1)                           | 4                    |
| [albert/albert-xxlarge-v2](<docs/models/albert/albert-xxlarge-v2>)                                   | 🚧       | 1       | 14256.1                   |                                   0.0625319   | 5.675691015381123                             | 98.54          | 791 (21)                        | 24 (1)                          | 3                    |
| [dla34.in1k-train](<docs/models/dla34.in1k-train>)                                                   | 🚧       | 1       | 47443.96                  |                                   0.101536    | 0.14085538659169405                           | 100.0          | 469 (18)                        | 230 (8)                         | 17                   |
| [ese_vovnet19b_dw.ra_in1k-train](<docs/models/ese_vovnet19b_dw.ra_in1k-train>)                       | 🚧       | 1       | 87957.79                  |                                   0.169603    | 0.28992818478862786                           | 100.0          | 383 (25)                        | 176 (10)                        | 16                   |
| [facebook/deit-base-patch16-224](<docs/models/facebook/deit-base-patch16-224>)                       | 🚧       | 1       | 19440.78                  |                                   0.0768813   | 8.4774499830451                               | 98.34          | 685 (17)                        | 1 (1)                           | 1                    |
| [facebook/deit-base-patch16-224-train](<docs/models/facebook/deit-base-patch16-224-train>)           | 🚧       | 1       | 33105.3                   |                                   0.0135327   | 0.6991882424505149                            | 100.0          | 1854 (27)                       | 127 (8)                         | 2                    |
| [ghostnet_100.in1k-train](<docs/models/ghostnet_100.in1k-train>)                                     | 🚧       | 1       | 131317.14                 |                                   0.8834      | 0.5246644770669157                            | 100.0          | 1469 (33)                       | 562 (12)                        | 64                   |
| [ghostnetv2_100.in1k](<docs/models/ghostnetv2_100.in1k>)                                             | 🚧       | 1       | 66524.11                  |                                   0.641552    | 8.855042946958292                             | 99.65          | 683 (18)                        | 24 (2)                          | 68                   |
| [ghostnetv2_100.in1k-train](<docs/models/ghostnetv2_100.in1k-train>)                                 | 🚧       | 1       | 65553.84                  |                                   0.519116    | 0.23894862604540024                           | 100.0          | 2001 (39)                       | 852 (17)                        | 68                   |
| [googlenet](<docs/models/googlenet>)                                                                 | 🚧       | 1       | 98841.8                   |                                   0.404693    | 38.52080123266564                             | 99.67          | 214 (15)                        | 1 (1)                           | 51                   |
| [hrnet_w18.ms_aug_in1k](<docs/models/hrnet_w18.ms_aug_in1k>)                                         | 🚧       | 1       | 116481.65                 |                                   0.170249    | 5.616399887672002                             | 99.62          | 1209 (11)                       | 31 (1)                          | 0                    |
| [hrnet_w18.ms_aug_in1k-train](<docs/models/hrnet_w18.ms_aug_in1k-train>)                             | 🚧       | 1       | 161550.46                 |                                   0.077946    | 0.10622781830369048                           | 100.0          | 3998 (21)                       | 1973 (9)                        | 0                    |
| [inception_v4.tf_in1k](<docs/models/inception_v4.tf_in1k>)                                           | 🚧       | 1       | 107812.78                 |                                   0.0788052   | 5.477051155657794                             | 99.11          | 495 (11)                        | 14 (1)                          | 84                   |
| [inception_v4.tf_in1k-train](<docs/models/inception_v4.tf_in1k-train>)                               | 🚧       | 1       | 132312.32                 |                                   0.0302181   | 0.04445380938028723                           | 100.0          | 1851 (24)                       | 932 (11)                        | 80                   |
| [mixer_b16_224.goog_in21k](<docs/models/mixer_b16_224.goog_in21k>)                                   | 🚧       | 1       | 16039.28                  |                                   0.0619017   | 7.558007709167864                             | 3.65           | 356 (11)                        | 1 (1)                           | 0                    |
| [mixer_b16_224.goog_in21k-train](<docs/models/mixer_b16_224.goog_in21k-train>)                       | 🚧       | 1       | 24896.02                  |                                   0.0179952   | 0.681398502286092                             | 100.0          | 959 (18)                        | 101 (6)                         | 0                    |
| [mobilenetv1_100.ra4_e3600_r224_in1k-train](<docs/models/mobilenetv1_100.ra4_e3600_r224_in1k-train>) | 🚧       | 1       | 41506.11                  |                                   0.344235    | 0.43718522663682147                           | 100.0          | 258 (16)                        | 164 (7)                         | 0                    |
| [regnet_y_128gf](<docs/models/regnet_y_128gf>)                                                       | 🚧       | 1       | 239350.27                 |                                   0.00201943  | 0.019275674137789457                          | 98.91          | 447 (10)                        | 3 (1)                           | 0                    |
| [ssd300_vgg16](<docs/models/ssd300_vgg16>)                                                           | 🚧       | 1       | 109552.29                 |                                   0.28915     | 0.654338921387722                             | N/A            | 251 (26)                        | 6 (3)                           | 37                   |
| [ssdlite320_mobilenet_v3_large](<docs/models/ssdlite320_mobilenet_v3_large>)                         | 🚧       | 1       | 140529.06                 |                                   1.78974     | 0.445795700746262                             | 46.25          | 447 (28)                        | 5 (2)                           | 32                   |
| [swin_b](<docs/models/swin_b>)                                                                       | 🚧       | 1       | 127832.5                  |                                   0.0685691   | 3.615982643283312                             | 92.77          | 2492 (32)                       | 110 (2)                         | 479                  |
| [swin_s](<docs/models/swin_s>)                                                                       | 🚧       | 1       | 31843.99                  |                                   0.119869    | 3.8392137290282946                            | 91.71          | 2492 (32)                       | 110 (2)                         | 479                  |
| [swin_t](<docs/models/swin_t>)                                                                       | 🚧       | 1       | 104429.87                 |                                   0.222364    | 7.540340823405217                             | 96.62          | 1238 (32)                       | 50 (2)                          | 227                  |
| [swin_v2_b](<docs/models/swin_v2_b>)                                                                 | 🚧       | 1       | 145120.72                 |                                   0.0546622   | 2.5972002181648186                            | 11.96          | 3140 (40)                       | 158 (3)                         | 473                  |
| [swin_v2_s](<docs/models/swin_v2_s>)                                                                 | 🚧       | 1       | 37176.44                  |                                   0.0940853   | 2.744161795779479                             | 31.41          | 3140 (40)                       | 158 (3)                         | 473                  |
| [swin_v2_t](<docs/models/swin_v2_t>)                                                                 | 🚧       | 1       | 104790.14                 |                                   0.174632    | 5.044390637610976                             | 44.1           | 1562 (40)                       | 74 (3)                          | 221                  |
| [tf_efficientnet_lite0.in1k-train](<docs/models/tf_efficientnet_lite0.in1k-train>)                   | 🚧       | 1       | 90493.44                  |                                   0.452397    | 0.17602937578223055                           | 100.0          | 452 (17)                        | 285 (8)                         | 5                    |
| [tf_efficientnet_lite1.in1k-train](<docs/models/tf_efficientnet_lite1.in1k-train>)                   | 🚧       | 1       | 97613.98                  |                                   0.301349    | 0.13093529701362774                           | 100.0          | 587 (17)                        | 370 (8)                         | 5                    |
| [tf_efficientnet_lite2.in1k-train](<docs/models/tf_efficientnet_lite2.in1k-train>)                   | 🚧       | 1       | 84724.87                  |                                   0.266317    | 0.09985152078858736                           | 100.0          | 587 (17)                        | 370 (8)                         | 5                    |
| [tf_efficientnet_lite3.in1k](<docs/models/tf_efficientnet_lite3.in1k>)                               | 🚧       | 1       | 75161.96                  |                                   0.468957    | 3.8330330790754727                            | 99.15          | 221 (9)                         | 5 (1)                           | 5                    |
| [tf_efficientnet_lite3.in1k-train](<docs/models/tf_efficientnet_lite3.in1k-train>)                   | 🚧       | 1       | 81919.58                  |                                   0.163211    | 0.06857774556147686                           | 100.0          | 668 (17)                        | 426 (9)                         | 5                    |
| [tf_efficientnet_lite4.in1k](<docs/models/tf_efficientnet_lite4.in1k>)                               | 🚧       | 1       | 89246.89                  |                                   0.221894    | 2.1276143060785944                            | 99.21          | 275 (9)                         | 6 (1)                           | 5                    |
| [tf_efficientnet_lite4.in1k-train](<docs/models/tf_efficientnet_lite4.in1k-train>)                   | 🚧       | 1       | 119585.57                 |                                   0.0660973   | 0.03811944575850645                           | 100.0          | 830 (17)                        | 529 (9)                         | 5                    |
| [vit_b_16](<docs/models/vit_b_16>)                                                                   | 🚧       | 1       | 29908.57                  |                                   0.0648378   | 6.643194047698134                             | 99.54          | 552 (17)                        | 1 (1)                           | 1                    |
| [vit_b_32](<docs/models/vit_b_32>)                                                                   | 🚧       | 1       | 15936.93                  |                                   0.18485     | 7.280669821623589                             | 98.68          | 552 (17)                        | 1 (1)                           | 1                    |
| [vit_h_14](<docs/models/vit_h_14>)                                                                   | 🚧       | 1       | 617122.16                 |                                   0.00151608  | 0.42022103626507545                           | 98.59          | 1452 (17)                       | 1 (1)                           | 1                    |
| [vit_l_16](<docs/models/vit_l_16>)                                                                   | 🚧       | 1       | 54062.07                  |                                   0.0194979   | 3.5980282805022847                            | 99.74          | 1092 (17)                       | 1 (1)                           | 1                    |
| [vit_l_32](<docs/models/vit_l_32>)                                                                   | 🚧       | 1       | 28340.8                   |                                   0.0606107   | 4.980327705563026                             | 98.97          | 1092 (17)                       | 1 (1)                           | 1                    |
| [xception71.tf_in1k-train](<docs/models/xception71.tf_in1k-train>)                                   | 🚧       | 1       | 155151.67                 |                                   0.0171507   | 0.017072278392863516                          | 100.0          | 1378 (18)                       | 806 (7)                         | 0                    |
| [FLAN-T5](<docs/models/FLAN-T5>)                                                                     | ❌       | N/A     | N/A                       |                                   0.278577    | N/A                                           | N/A            | 20020 (38)                      | N/A                             | N/A                  |
| [GPTNeo](<docs/models/GPTNeo>)                                                                       | ❌       | N/A     | N/A                       |                                   0.0822697   | N/A                                           | N/A            | 2733 (35)                       | N/A                             | N/A                  |
| [OPT](<docs/models/OPT>)                                                                             | ❌       | N/A     | N/A                       |                                   0.0475795   | N/A                                           | N/A            | 4003 (32)                       | N/A                             | N/A                  |
| [Whisper](<docs/models/Whisper>)                                                                     | ❌       | N/A     | N/A                       |                                   0.00418668  | N/A                                           | N/A            | 4310 (21)                       | N/A                             | N/A                  |
| [codegen](<docs/models/codegen>)                                                                     | ❌       | N/A     | N/A                       |                                   0.144417    | N/A                                           | N/A            | 9183 (37)                       | N/A                             | N/A                  |
| [densenet201](<docs/models/densenet201>)                                                             | ❌       | N/A     | N/A                       |                                   0.221702    | N/A                                           | N/A            | 712 (10)                        | N/A                             | N/A                  |
| [speecht5-tts](<docs/models/speecht5-tts>)                                                           | ❌       | N/A     | N/A                       |                                   0.0202097   | N/A                                           | N/A            | 6942 (40)                       | N/A                             | N/A                  |
| [t5-base](<docs/models/t5-base>)                                                                     | ❌       | N/A     | N/A                       |                                   0.215336    | N/A                                           | N/A            | 14681 (38)                      | N/A                             | N/A                  |
| [t5-large](<docs/models/t5-large>)                                                                   | ❌       | N/A     | N/A                       |                                   0.0902961   | N/A                                           | N/A            | 22696 (38)                      | N/A                             | N/A                  |
| [t5-small](<docs/models/t5-small>)                                                                   | ❌       | N/A     | N/A                       |                                   0.390762    | N/A                                           | N/A            | 6118 (38)                       | N/A                             | N/A                  |

### Explanation of Metrics

**Model**: Name of the model.  
**Status**: Indicates whether the model is ❌ traced / 🚧 compiled / ✅ E2E on device.  
**Batch**: Batch size used for inference  
**Compiled First Run (ms)**: Time until the first compiled run finishes (ms), including compilation time and warming caches.  
**Original Throughput (Inferences Per Second)**: Execution throughput (in inferences per second) of the model before conversion.  
**Compiled Throughput (Inferences Per Second)**: Execution throughput (in inferences per second) of the model after conversion once caches are warm.  
**Accuracy (%)**: Model accuracy on a predefined test dataset after conversion.  
**Torch Ops Before (Unique Ops)**: The total number of operations used by the model in the original Torch implementation. The number in parenthesis represents the total unique ops.  
**Torch Ops Remain (Unique Ops)**: The total number of operations used after conversion to TTNN. The number in parenthesis represents the total unique ops.  
**To/From Device Ops**: The number of `to/from_device` operations (data transfer to/from the device).  

***

## Quickstart

The `torch_ttnn` module has a `backend` function, which can be used with the `torch.compile()`.

```python
import torch
import torch_ttnn

# A torch Module
class FooModule(torch.nn.Module):
    ...
# Create a module
module = FooModule()

# Compile the module, with ttnn backend
device = ttnn.open_device(device_id=0)
option = torch_ttnn.TorchTtnnOption(device=self.device)
ttnn_module = torch.compile(module, backend=torch_ttnn.backend, options=option)

# Running inference / training
ttnn_module(input_data)
```

## Tracer
The tracer dump the information of fx graph such as node's op_name and shape.

For example, you can run this script to parse the information
```
PYTHONPATH=$(pwd) python3 tools/stat_models.py --trace_orig --backward --profile
ls stat/raw
```

By default, the raw result will be stored at `stat/raw`, and you can run this script to generate the report
```
python3 tools/generate_report.py
ls stat/
```
Now the `stat/` folder have these report
 - `fw_node_count.csv`
 - `bw_node_count.csv`
 - `fw_total_input_size_dist/`
 - `bw_total_input_size_dist/`
 - `fw_total_output_size_dist/`
 - `bw_total_output_size_dist/`
 - `profile/`

The `node_count.csv` show the node with `op_type` appear in the fx graph. This report can help analyze the frequency of op type appear in the graph.

The `*_total_*_size_dist/` statistics the `op_type`'s input/output_size distribution from all fx graph recored in `stat/raw`. This report can help analyze the memory footprint durning the calculation of `op_type`.

 - Notice: the default `input_shapes` in `tools/stat_torchvision.py` is `[1,3,224,224]`, which has dependency with `*_total_*_size_dist/` report.

 - Notice: the [aten ir interface is in there](https://pytorch.org/docs/stable/torch.compiler_ir.html)

[The `profile/` is the tools provided by pytorch](https://pytorch.org/tutorials/recipes/recipes/profiler_recipe.html), you can open it by the url: chrome://tracing


# For developers

## Install torch-ttnn with editable mode

During development, you may want to use the torch-ttnn package for testing.
In order to do that, you can install the torch-ttnn package in "editable"
mode with

```shell
pip install -e .
```

Now, you can utilize `torch_ttnn` in your Python code. Any modifications you make to the `torch_ttnn` package will take effect immediately, eliminating the need for constant reinstallation via pip.

## Build wheel file

For developers want to deploy the wheel, you can build the wheel file with

```shell
python -m build
```

Then you can upload the `.whl` file to the PyPI (Python Package Index).

## Run transformer models
To run transformer model with ttnn backend, run:
```
PYTHONPATH="$TT_METAL_HOME:$(pwd)" python3 tools/run_transformers.py --model "phiyodr/bert-large-finetuned-squad2" --backend torch_ttnn
```

You can also substitute the backend with `torch_stat` to run a reference comparison.

